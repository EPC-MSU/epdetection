## Описание папки utilities

В этой папке лежат скрипты для обучения/тестирования нейронных сетей, подготовки и проверки базы для обучения.

**Для их запуска нужно установить основные зависимости, запустив install_dependencies.bat**

* `augmentation.py` -- скрипт для раздутия базы для обучения с помощью поворотов/отражений добавления шума/смещений/размытия и пр. которые накладываются на изображения. Каждое искажение представляет собой функцию. На входе -- лист исходных изображений, на выходе лист искаженных изображений.

	* Как пользоваться: Указать в коде LOAD_PATH, SAVE_PATH и выбрать какие искажения для аугментации нужно применить. 
	
* `data_preparing.py` -- скрипт с функциями для вырезания центра элемента, показа слоёв нейронной сети, ручного predict-а нейронной сети
  
  * Как пользоваться: выбрать нужную функцию, проверить она ли выбрана в main  указать пути и запустить
  
* `generate_incorrect.py` --  скрипт генерирует неверные изображения компонентов, нарезая платы.
  * Требования: установленный python и модуль opencv-python
  * Аргументы командной строки:
  * `-el` -- Имя папки с элементом, например SOT323
  * `-n` -- Количество изображений, которое нужно сгенерировать
  * Например, чтобы сгенерировать 200 неверных изображений SMD0603_CL, нужно ввести в консоли:
  * ```bash
    python generate_incorrect.py -el SMD0603_CL -n 200
    ```
  
* `nn_data_checker.py` -- скрипт содержащий три функции

  * renamer -- переименовывает все файлы в указанной директории и поддиректориях указывая номер файла в названии (счёт файлов независимый в каждой папке)
  * Resolution Checker -- проверяет все ли файлы в папке имеют одинаковое разрешение
  * FOLDER PLOT -- выводит в консоль структуру файлов и папок в указанной директории и разрешение изображений в них
  
* `nn_debug` -- скрипт, который тестирует нейросеть на произвольных данных с построением графика номер_кандидата/вероятность-что-кандидат-относится-к-классу. Специалист по нейронным сетям исходя из этого графика сможет выявить аномалии нейронной сети или проверить её качество

* `nn_test` -- подсчитывает количество верных и неверных предсказаний на произвольных данных

* `test_gpu` -- позволяет увидеть на каких девайсах может запуститься tensorflow

* `nn_train` -- главный скрипт в этой папке. Запускает обучение нейронной сети по указанным данным.

  * Умеет автоматически определять количество указанных классов, воспроизводить два вида звуковых сигналов при ошибке и при завершении обучения.
  * Сохраняет модели и их структуру в указанные папки
  * Строит графики точности и потерь и сохраняет их в ту же папку
  * Имеет настройку ONLY_EPOCH_END которая при False строит максимально точный график обучения на каждом батче
  
* `pyan_plot.bat` - если этот файл вместе с архивом `pyan.tar.gz` поместить в любое место и в батнике написать интересующее название файла и запустить батник, то эта утилита построит красивый график этого питон файла с зависимостями.


